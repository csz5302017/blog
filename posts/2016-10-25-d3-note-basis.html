<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>D3 Note - Basis | wxsm&#39;s space</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="shortcut icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" size="200x200" href="favicon-iphone.png">
    <link rel="alternate" type="application/rss+xml" href="https://wxsm.space/rss.xml" title="wxsm&#39;s space RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://wxsm.space/feed.atom" title="wxsm&#39;s space Atom Feed">
    <link rel="alternate" type="application/json" href="https://wxsm.space/feed.json" title="wxsm&#39;s space JSON Feed">
    <meta name="description" content="Just another personal blog.">
    <meta name="google-site-verification" content="ekuL5J7xK1IdFtP13v3KxpuGKnYS1oCT9PvZdjYm8Eg">
    
    <link rel="preload" href="/assets/css/0.styles.0b73a1a5.css" as="style"><link rel="preload" href="/assets/js/app.6cfc030a.js" as="script"><link rel="preload" href="/assets/js/4.93b87abf.js" as="script"><link rel="preload" href="/assets/js/1.89483f76.js" as="script"><link rel="preload" href="/assets/js/81.208d2216.js" as="script"><link rel="prefetch" href="/assets/js/10.ab04745f.js"><link rel="prefetch" href="/assets/js/100.edb64ecf.js"><link rel="prefetch" href="/assets/js/101.1010310d.js"><link rel="prefetch" href="/assets/js/102.511df75d.js"><link rel="prefetch" href="/assets/js/103.16e9cb35.js"><link rel="prefetch" href="/assets/js/104.7f8ddf0f.js"><link rel="prefetch" href="/assets/js/105.0a9270d2.js"><link rel="prefetch" href="/assets/js/106.98d28896.js"><link rel="prefetch" href="/assets/js/107.19272619.js"><link rel="prefetch" href="/assets/js/108.2f03290c.js"><link rel="prefetch" href="/assets/js/109.34d5274f.js"><link rel="prefetch" href="/assets/js/11.789c3d3f.js"><link rel="prefetch" href="/assets/js/110.981d94b7.js"><link rel="prefetch" href="/assets/js/111.4a987be8.js"><link rel="prefetch" href="/assets/js/112.68d3196c.js"><link rel="prefetch" href="/assets/js/113.c7e5d127.js"><link rel="prefetch" href="/assets/js/114.ee3f3722.js"><link rel="prefetch" href="/assets/js/115.be2b9699.js"><link rel="prefetch" href="/assets/js/116.5c80bfe3.js"><link rel="prefetch" href="/assets/js/117.f88a25dd.js"><link rel="prefetch" href="/assets/js/118.a3c12cf6.js"><link rel="prefetch" href="/assets/js/119.dce263a5.js"><link rel="prefetch" href="/assets/js/12.4b8d379b.js"><link rel="prefetch" href="/assets/js/120.47ddd7b8.js"><link rel="prefetch" href="/assets/js/121.4e591df0.js"><link rel="prefetch" href="/assets/js/122.5c93955e.js"><link rel="prefetch" href="/assets/js/123.a474eccb.js"><link rel="prefetch" href="/assets/js/124.7eea214b.js"><link rel="prefetch" href="/assets/js/125.81d67a4c.js"><link rel="prefetch" href="/assets/js/126.ad1b502d.js"><link rel="prefetch" href="/assets/js/127.8a0f42e6.js"><link rel="prefetch" href="/assets/js/128.29add6fe.js"><link rel="prefetch" href="/assets/js/129.73908fd7.js"><link rel="prefetch" href="/assets/js/13.159fc0df.js"><link rel="prefetch" href="/assets/js/130.c6b02154.js"><link rel="prefetch" href="/assets/js/131.9cec48b5.js"><link rel="prefetch" href="/assets/js/132.49db2327.js"><link rel="prefetch" href="/assets/js/133.00073acc.js"><link rel="prefetch" href="/assets/js/134.ed8e0fe8.js"><link rel="prefetch" href="/assets/js/135.6f042a42.js"><link rel="prefetch" href="/assets/js/136.250fb5df.js"><link rel="prefetch" href="/assets/js/137.c0e72bfb.js"><link rel="prefetch" href="/assets/js/138.46dd9692.js"><link rel="prefetch" href="/assets/js/14.30623d81.js"><link rel="prefetch" href="/assets/js/15.e2293de2.js"><link rel="prefetch" href="/assets/js/16.22b543e1.js"><link rel="prefetch" href="/assets/js/17.905a27bb.js"><link rel="prefetch" href="/assets/js/18.0baf70db.js"><link rel="prefetch" href="/assets/js/19.1c3030a4.js"><link rel="prefetch" href="/assets/js/20.c3f86680.js"><link rel="prefetch" href="/assets/js/21.1da78550.js"><link rel="prefetch" href="/assets/js/22.9f4af9b3.js"><link rel="prefetch" href="/assets/js/23.9ed436d8.js"><link rel="prefetch" href="/assets/js/24.8a42d96d.js"><link rel="prefetch" href="/assets/js/25.523c6fc4.js"><link rel="prefetch" href="/assets/js/26.7414f67e.js"><link rel="prefetch" href="/assets/js/27.0b301082.js"><link rel="prefetch" href="/assets/js/28.e0f2a09e.js"><link rel="prefetch" href="/assets/js/29.761d4600.js"><link rel="prefetch" href="/assets/js/30.4fec090b.js"><link rel="prefetch" href="/assets/js/31.2637b20f.js"><link rel="prefetch" href="/assets/js/32.8cce2838.js"><link rel="prefetch" href="/assets/js/33.04deb20e.js"><link rel="prefetch" href="/assets/js/34.037decd9.js"><link rel="prefetch" href="/assets/js/35.723305f1.js"><link rel="prefetch" href="/assets/js/36.fe6550c8.js"><link rel="prefetch" href="/assets/js/37.a23d1c3a.js"><link rel="prefetch" href="/assets/js/38.aa41d681.js"><link rel="prefetch" href="/assets/js/39.e10c9e15.js"><link rel="prefetch" href="/assets/js/40.cd3ceb00.js"><link rel="prefetch" href="/assets/js/41.64cba4ba.js"><link rel="prefetch" href="/assets/js/42.30b70a81.js"><link rel="prefetch" href="/assets/js/43.37583c37.js"><link rel="prefetch" href="/assets/js/44.5e69afc7.js"><link rel="prefetch" href="/assets/js/45.3958b434.js"><link rel="prefetch" href="/assets/js/46.f6bb84f5.js"><link rel="prefetch" href="/assets/js/47.f9a32233.js"><link rel="prefetch" href="/assets/js/48.b62e6ee9.js"><link rel="prefetch" href="/assets/js/49.372da33b.js"><link rel="prefetch" href="/assets/js/5.3bcab57c.js"><link rel="prefetch" href="/assets/js/50.cad81ba6.js"><link rel="prefetch" href="/assets/js/51.c1fa0b0d.js"><link rel="prefetch" href="/assets/js/52.4a8bba81.js"><link rel="prefetch" href="/assets/js/53.b427954e.js"><link rel="prefetch" href="/assets/js/54.448d5201.js"><link rel="prefetch" href="/assets/js/55.76ec48c7.js"><link rel="prefetch" href="/assets/js/56.d6e69358.js"><link rel="prefetch" href="/assets/js/57.28eeb571.js"><link rel="prefetch" href="/assets/js/58.636a9b5b.js"><link rel="prefetch" href="/assets/js/59.ea737351.js"><link rel="prefetch" href="/assets/js/6.0b15f6a7.js"><link rel="prefetch" href="/assets/js/60.71561f99.js"><link rel="prefetch" href="/assets/js/61.ad869f67.js"><link rel="prefetch" href="/assets/js/62.708d1b48.js"><link rel="prefetch" href="/assets/js/63.7a6b0770.js"><link rel="prefetch" href="/assets/js/64.c30bee6f.js"><link rel="prefetch" href="/assets/js/65.86f85ec4.js"><link rel="prefetch" href="/assets/js/66.940160c0.js"><link rel="prefetch" href="/assets/js/67.0b1a3a8c.js"><link rel="prefetch" href="/assets/js/68.fa3f313f.js"><link rel="prefetch" href="/assets/js/69.13771080.js"><link rel="prefetch" href="/assets/js/7.3ac6269f.js"><link rel="prefetch" href="/assets/js/70.865c5fcb.js"><link rel="prefetch" href="/assets/js/71.14ed2e6e.js"><link rel="prefetch" href="/assets/js/72.d358bcbd.js"><link rel="prefetch" href="/assets/js/73.4f80377c.js"><link rel="prefetch" href="/assets/js/74.6bd59ba9.js"><link rel="prefetch" href="/assets/js/75.0644e837.js"><link rel="prefetch" href="/assets/js/76.187e10c1.js"><link rel="prefetch" href="/assets/js/77.c0cbd856.js"><link rel="prefetch" href="/assets/js/78.bd9a9221.js"><link rel="prefetch" href="/assets/js/79.bd8af51d.js"><link rel="prefetch" href="/assets/js/8.55b06485.js"><link rel="prefetch" href="/assets/js/80.c3a22465.js"><link rel="prefetch" href="/assets/js/82.cd62e4b6.js"><link rel="prefetch" href="/assets/js/83.a9eb35e5.js"><link rel="prefetch" href="/assets/js/84.719b32b2.js"><link rel="prefetch" href="/assets/js/85.09e6f534.js"><link rel="prefetch" href="/assets/js/86.13fe7503.js"><link rel="prefetch" href="/assets/js/87.a7004328.js"><link rel="prefetch" href="/assets/js/88.6408f1f9.js"><link rel="prefetch" href="/assets/js/89.1c49bc09.js"><link rel="prefetch" href="/assets/js/9.bad3ab49.js"><link rel="prefetch" href="/assets/js/90.eee956c1.js"><link rel="prefetch" href="/assets/js/91.d5cfc841.js"><link rel="prefetch" href="/assets/js/92.e2bbcb0f.js"><link rel="prefetch" href="/assets/js/93.774c5a59.js"><link rel="prefetch" href="/assets/js/94.af84d334.js"><link rel="prefetch" href="/assets/js/95.0b7c3d44.js"><link rel="prefetch" href="/assets/js/96.1472868a.js"><link rel="prefetch" href="/assets/js/97.a9e54459.js"><link rel="prefetch" href="/assets/js/98.fb4b3815.js"><link rel="prefetch" href="/assets/js/99.00b68490.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.407c587a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0b73a1a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-37172400><main class="page" data-v-37172400><div class="theme-default-content content__default" data-v-37172400><div class="space-header" data-v-37172400><a href="/" class="home-link router-link-active">wxsm's space</a> <div class="links"><span><a href="/" class="site-link router-link-active">home</a> <span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span></span><span><a href="/projects/" class="site-link">projects</a> <span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span></span><span><a href="/about/" class="site-link">about</a> <span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span></span><span><a href="/links/" class="site-link">links</a> <!----></span></div> <div class="search-box-container"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div> <div class="title" data-v-37172400><h3 data-v-37172400>Oct 25, 2016</h3> <h1 data-v-37172400>D3 Note - Basis</h1></div> <div class="content__default" data-v-37172400><p>D3 (Data-Driven Documents) 是一个 JavaScript Library，用来做 Web 端的数据可视化实现以及各种绘图。</p> <blockquote><p><strong>D3.js</strong> is a JavaScript library for manipulating documents based on data. <strong>D3</strong> helps you bring data to life using HTML, SVG, and CSS.</p></blockquote> <p>学习 D3 需要很多预备知识：</p> <ol><li>HTML / DOM</li> <li>CSS</li> <li>JavaScript (better with jQuery)</li> <li>SVG</li></ol> <p>HTML / CSS 不必多说，因为 D3 含有大量链式操作函数以及选择器等，因此如果有 jQuery 基础将轻松很多。此外，由于一般采用 SVG 方式进行绘图，所以 SVG 基础知识也需要掌握。</p> <p>虽然必须的预备知识如此之多，但 D3 的定位其实是 Web 前端绘图的底层工具，所谓底层，即是操作复杂而功能强大者。</p> <h2 id="关于-svg"><a href="#关于-svg" class="header-anchor">#</a> 关于 SVG</h2> <p>SVG (Scalable Vector Graphics) 是一种绘图标准，已经被绝大多数的现代浏览器所支持。SVG 采用 XML 语法定义图像，可直接嵌入 HTML 中使用。</p> <p>SVG 的特点是矢量绘图（与 Canvas 不同），除了预设样式以外同时也支持 CSS 样式。</p> <p>比如，画一个园圈，坐标为 (100, 50)，半径为 40px，拥有 2px 的黑色 border，以及红色填充：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>black<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>red<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>SVG 有一些预定义的形状元素，可被开发者使用和操作：</p> <ul><li>矩形 <code>&lt;rect&gt;</code></li> <li>圆形 <code>&lt;circle&gt;</code></li> <li>椭圆 <code>&lt;ellipse&gt;</code></li> <li>线 <code>&lt;line&gt;</code></li> <li>折线 <code>&lt;polyline&gt;</code></li> <li>多边形 <code>&lt;polygon&gt;</code></li> <li>路径 <code>&lt;path&gt;</code></li></ul> <p>其中，<code>path</code> 是功能最强大者，使用 <code>path</code> 可以构成所有图形。</p> <h2 id="选择器"><a href="#选择器" class="header-anchor">#</a> 选择器</h2> <h3 id="选择元素"><a href="#选择元素" class="header-anchor">#</a> 选择元素</h3> <p>D3 使用与 jQuery 类似的选择器来获取 HTML 元素。常用的方法有：</p> <ul><li><code>d3.select(selector)</code></li> <li><code>d3.selectAll(selector)</code></li></ul> <p>（参数既可以传 selector 也可以直接传 HTML Element ）</p> <p>顾名思义，<code>selectAll</code> 就是选择所有符合条件的元素了，那么 <code>select</code> 选择的是符合条件的第一个元素。如：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span> <span class="token comment">//选择 body 元素</span>

d3<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span> <span class="token comment">//选择所有 p 元素</span>

d3<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'.className'</span><span class="token punctuation">)</span> <span class="token comment">//选择所有 class 包含 className 的元素</span>
</code></pre></div><p>更多就不说了。</p> <h3 id="操作选择"><a href="#操作选择" class="header-anchor">#</a> 操作选择</h3> <p>选择器返回的是一组<strong>选择</strong>（selection），这组<strong>选择</strong>可以进行一些操作，如：</p> <ul><li>在此选择的基础上继续选择；</li> <li>改变属性；</li> <li>改变样式；</li> <li>绑定事件；</li> <li>插入、删除；</li> <li>绑定数据。</li></ul> <p>大多数操作都与 jQuery 十分类似，同时也支持链式操作，不再赘述。只是这个“绑定数据”操作稍有特别。</p> <h2 id="数据绑定"><a href="#数据绑定" class="header-anchor">#</a> 数据绑定</h2> <p>通过 D3 可以把数据“绑定”到 HTML 元素上，绑定的目的主要是为了方便一些需要相应数据才能进行的元素操作（如：更改元素大小、位置等）。</p> <p>绑定数据有两个方法：</p> <ul><li><code>datum</code>: 将一个数据绑定到选择上；</li> <li><code>data</code>: 将一个数组绑定到选择上，数组的各项分别与选择的各项一一对应。</li></ul> <p>下面引用一个例子来说明这二者的不同。假设有如下三个节点：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Apple<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Pear<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Banana<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="datum"><a href="#datum" class="header-anchor">#</a> datum</h3> <p>执行以下代码：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">'datum'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> p <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

p<span class="token punctuation">.</span><span class="token function">datum</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Element </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> bind with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>d<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>将得到：</p> <div class="language- extra-class"><pre class="language-text"><code>Element 0 bind with datum
Element 1 bind with datum
Element 2 bind with datum
</code></pre></div><p>在对选择进行操作时，传入的<strong>值</strong>可以是<strong>值</strong>，也可以是函数。当传入函数时，D3 会向函数注入两个参数，分别是 d (data) 与 i (index)，代表当前元素绑定的数据与其索引。</p> <h3 id="data"><a href="#data" class="header-anchor">#</a> data</h3> <p>执行以下代码：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> strArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'data0'</span><span class="token punctuation">,</span> <span class="token string">'data1'</span><span class="token punctuation">,</span> <span class="token string">'data2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> p <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

p<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>strArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Element </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> bind with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>d<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>将得到：</p> <div class="language- extra-class"><pre class="language-text"><code>Element 0 bind with data0
Element 1 bind with data1
Element 2 bind with data2
</code></pre></div><p>可以看到，数组中的 3 个项分别与 3 个 p 元素绑定到了一起。因此，可以将 <code>datum</code> 看作是 <code>data</code> 函数的一个特例，实际开发中使用更多的是 <code>data</code> 函数。</p> <h2 id="实践-简单柱状图"><a href="#实践-简单柱状图" class="header-anchor">#</a> 实践：简单柱状图</h2> <p>先定义一个 SVG 画布，并将它插入到 HTML 的 body 中去：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> width <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">,</span>
  height <span class="token operator">=</span> <span class="token number">300</span>；

<span class="token keyword">let</span> svg <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在这里，画布的宽高都为 300 像素。</p> <p>然后，定义一组数据：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>最后使用以上数据画出柱状图，柱子使用 SVG 预定义的 <code>rect</code> 元素：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> rectWidth <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>

svg<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'rect'</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'rect'</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> height <span class="token operator">-</span> d<span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> i <span class="token operator">*</span> rectWidth<span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> rectWidth <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'fill'</span><span class="token punctuation">,</span> <span class="token string">'steelblue'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>rectWidth</code> 表示柱子的宽度，至于坐标、宽高则分别通过 x / y 以及 height / width 属性来控制，效果如下：</p> <p><img src="https://static.wxsm.space/blog/48595801-401d6c80-e991-11e8-97c6-580489b7aeab.gif" alt=""></p> <p>可以发现，这里并没有指定需要插入的 <code>rect</code> 个数，但 D3 却根据数据量自动地把图画出来了，这个工作是通过 <code>enter</code> 语句完成的。关于其工作原理，下回分解。</p></div> <br data-v-37172400> <div class="last-updated" data-v-37172400><span class="prefix" data-v-37172400>Last Updated:</span> <span class="time" data-v-37172400>3 months ago</span></div>  <div class="space-footer" data-v-a298b7ba data-v-37172400><p class="footer-text" data-v-a298b7ba>© 2021 wxsm</p> <p class="footer-text" data-v-a298b7ba>
    Powered by <a href="https://vuepress.vuejs.org/" target="_blank" data-v-a298b7ba>VuePress</a>
     · 
    Theme by <a href="https://github.com/wxsms/vuepress-theme-mini" target="_blank" data-v-a298b7ba>mini</a></p></div></div></main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.6cfc030a.js" defer></script><script src="/assets/js/4.93b87abf.js" defer></script><script src="/assets/js/1.89483f76.js" defer></script><script src="/assets/js/81.208d2216.js" defer></script>
  </body>
</html>
